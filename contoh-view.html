<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test HTML2Canvas & Print Friendly</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* --- Style Tampilan Normal --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px; /* Jarak antar tombol */
        }

        button {
            background-color: #059669;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 6px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            font-weight: 600;
        }
        
        button.btn-print {
            background-color: #4b5563; /* Warna abu-abu untuk tombol print */
        }

        #capture-area {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 800px;
            width: 100%;
        }

        h2 { text-align: center; color: #333; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        thead { background-color: #1e293b; color: white; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        tbody tr:nth-child(even) { background-color: #f8fafc; }

        .badge { padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; }
        .active { background-color: #dcfce7; color: #166534; }
        .pending { background-color: #fef9c3; color: #854d0e; }
        .inactive { background-color: #fee2e2; color: #991b1b; }

        /* --- BAGIAN PENTING: Style Khusus Saat Print (Ctrl+P) --- */
        @media print {
            /* 1. Sembunyikan tombol controls */
            .controls {
                display: none !important;
            }

            /* 2. Reset style body agar pas di kertas A4 */
            body {
                background-color: white;
                padding: 0;
                margin: 0;
            }

            /* 3. Hilangkan shadow/border container agar bersih */
            #capture-area {
                box-shadow: none;
                border: none;
                padding: 0;
                width: 100%;
                max-width: none; /* Gunakan lebar penuh kertas */
            }

            /* 4. Pastikan header tabel berwarna saat diprint (opsional, tergantung browser) */
            thead {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>

    <div class="controls">
        <button id="btn-copy" onclick="copyToClipboard()">
            üìã Salin Gambar
        </button>

        <button class="btn-print" onclick="window.print()">
            üñ®Ô∏è Print ke PDF
        </button>
    </div>

    <div id="capture-area">
        <h2>Laporan Data Karyawan</h2>
        <table>
            <thead>
                <tr>
                    <th>No</th>
                    <th>ID Pegawai</th>
                    <th>Nama Lengkap</th>
                    <th>Jabatan</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody id="table-body">
                </tbody>
        </table>
        <p style="margin-top: 20px; text-align: right; font-size: 12px; color: #666;">
            Generated on: <span id="date-now"></span>
        </p>
    </div>

    <script>
        // --- 1. Generate Data Dummy ---
        const tableBody = document.getElementById('table-body');
        const roles = ['Frontend Dev', 'Backend Dev', 'UI/UX Designer', 'Project Manager', 'QA Tester'];
        const statuses = ['active', 'pending', 'inactive'];
        function getRandomItem(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

        for (let i = 1; i <= 50; i++) {
            const randomRole = getRandomItem(roles);
            const randomStatus = getRandomItem(statuses);
            tableBody.innerHTML += `
                <tr>
                    <td>${i}</td>
                    <td>EMP-${1000 + i}</td>
                    <td>User Demo ${i}</td>
                    <td>${randomRole}</td>
                    <td><span class="badge ${randomStatus}">${randomStatus.toUpperCase()}</span></td>
                </tr>
            `;
        }
        document.getElementById('date-now').innerText = new Date().toLocaleDateString('id-ID');

        // --- 2. Logic Copy to Clipboard (Sama seperti sebelumnya) ---
        function copyToClipboard() {
            const element = document.getElementById('capture-area');
            const btn = document.getElementById('btn-copy');
            const originalText = btn.innerHTML;

            btn.innerText = "Processing...";
            html2canvas(element, { scale: 2, backgroundColor: "#ffffff" }).then(canvas => {
                canvas.toBlob(function(blob) {
                    try {
                        const item = new ClipboardItem({ "image/png": blob });
                        navigator.clipboard.write([item]).then(() => {
                            btn.innerText = "‚úÖ Copied!";
                            setTimeout(() => { btn.innerHTML = originalText; }, 2000);
                        });
                    } catch (err) {
                        alert("Gagal. Gunakan browser modern & HTTPS/Localhost.");
                        btn.innerHTML = originalText;
                    }
                });
            });
        }
    </script>
</body>
</html>